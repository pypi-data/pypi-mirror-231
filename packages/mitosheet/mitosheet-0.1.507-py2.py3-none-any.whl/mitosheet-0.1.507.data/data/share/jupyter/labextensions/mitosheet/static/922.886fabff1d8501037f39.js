"use strict";(self.webpackChunkmitosheet=self.webpackChunkmitosheet||[]).push([[922],{922:(e,t,n)=>{n.r(t),n.d(t,{MODULE_NAME:()=>l,MODULE_VERSION:()=>i,default:()=>s});const o=n(147),i=o.version,l=o.name,s=n(509).default},509:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var o=n(303),i=n(127);const l=new(n(745).LabIcon)({name:"mitosheet:mitosheet-jlab-icon",svgstr:'<svg width="7" height="11" viewBox="0 0 7 11" fill="none" xmlns="http://www.w3.org/2000/svg">    <rect x="0.871094" y="2.87109" width="5.52567" height="5.3994" fill="#D0B9FE"/>    <ellipse cx="3.63393" cy="2.80053" rx="2.76283" ry="2.0603" fill="#D0B9FE"/>    <ellipse cx="3.63393" cy="8.20092" rx="2.76283" ry="2.0603" fill="#D0B9FE"/>    <path d="M0.871094 2.94922H3.2966C3.57827 2.94922 3.80661 3.17755 3.80661 3.45922V3.45922C3.80661 3.74088 3.57827 3.96922 3.29661 3.96922H0.871094V2.94922Z" fill="#9D6CFF"/>    <path d="M0.871094 7.03125H3.2966C3.57827 7.03125 3.80661 7.25958 3.80661 7.54125V7.54125C3.80661 7.82292 3.57827 8.05125 3.29661 8.05125H0.871094V7.03125Z" fill="#9D6CFF"/>    <path d="M6.39673 4.99023H3.97122C3.68955 4.99023 3.46122 5.21857 3.46122 5.50023V5.50023C3.46122 5.7819 3.68955 6.01023 3.97122 6.01023H6.39673V4.99023Z" fill="#9D6CFF"/>    </svg>'}),s=["from mitosheet.public.v1 import *","from mitosheet.public.v2 import *","from mitosheet.public.v3 import *"];function a(e){const t=e.split(/\r?\n/).filter((e=>e.trim().length>0));return t.length>0?t.pop():void 0}function r(e){const t=a(e);return void 0!==t&&-1!==m(t).indexOf("sheet(")}function d(e,t){const n=m(e);return n.includes("sheet(")&&n.includes(`analysis_to_replay="${t}"`)}function c(e){const t=m(e);return r(e)&&t.includes("analysis_to_replay=")}function m(e){const t=/('[^']*'|"[^"]*")/;return e.split(t).map((e=>t.test(e)?e:e.replace(/\s+/g,""))).join("")}function u(){let e=document.activeElement;for(;null!==e&&!e.classList.contains("mito-container");)e=e.parentElement;return e}function h(e,t){if(null==e)return;const n=e.iter();let o=n.next(),i=0;for(;o;){if(i==t)return o;i++,o=n.next()}}function p(e){return null==e?"":e.modelDB.get("value").text}function b(e){return void 0!==e&&""===p(e).trim()}function v(e,t){var n,o;const i=null===(n=e.currentWidget)||void 0===n?void 0:n.content,l=null===(o=null==i?void 0:i.model)||void 0===o?void 0:o.cells;if(void 0===l)return;const s=l.iter();let a=s.next(),r=0;for(;a;){if(d(p(a),t))return[a,r];r++,a=s.next()}}function f(e,t){var n,o,i;if(t){const n=v(e,t);if(void 0!==n)return n}const l=null===(n=e.currentWidget)||void 0===n?void 0:n.content,s=null===(o=null==l?void 0:l.model)||void 0===o?void 0:o.cells;if(null==l||null==s)return;const a=null===(i=l.activeCell)||void 0===i?void 0:i.model,d=l.activeCellIndex,m=h(s,d-1);if(m&&r(p(m))&&!c(p(m)))return[m,d-1];if(a&&r(p(a))&&!c(p(a)))return[a,d];let u=d;for(;u>=0;){const e=h(s,u);if(e&&r(p(e))&&!c(p(e)))return[e,u];u--}}function y(e,t){null!=e&&(e.modelDB.get("value").text=t)}const x={id:"mitosheet:plugin",requires:[i.INotebookTracker],activate:function(e,t){(e=>{e.widgetAdded.connect(((e,t)=>{const n=new o.ToolbarButton({className:"toolbar-mito-button-class",icon:l,onClick:()=>{var e;null===(e=window.commands)||void 0===e||e.execute("mitosheet:create-empty-mitosheet")},tooltip:"Create a blank Mitosheet below the active code cell",label:"New Mitosheet"});t.toolbar.insertAfter("cellType","Create Mito Button",n)}))})(t),e.commands.addCommand("mitosheet:create-mitosheet-comm",{label:"Create Comm",execute:async e=>{var n,o,i,l;const s=e.kernelID,a=e.commTargetID;let r;if("kernel-00000000-0000-0000-0000-000000000000"===s)r=null===(o=null===(n=t.currentWidget)||void 0===n?void 0:n.context.sessionContext.session)||void 0===o?void 0:o.kernel;else{const e=t.find((e=>{var t,n;return(null===(n=null===(t=e.sessionContext.session)||void 0===t?void 0:t.kernel)||void 0===n?void 0:n.id)===s}));r=null===(l=null===(i=null==e?void 0:e.sessionContext)||void 0===i?void 0:i.session)||void 0===l?void 0:l.kernel}return null==r?"no_backend_comm_registered_error":r.createComm(a)}}),e.commands.addCommand("mitosheet:write-analysis-to-replay-to-mitosheet-call",{label:"Given an analysisName, writes it to the mitosheet.sheet() call that created this mitosheet, if it is not already written to this cell.",execute:e=>{const n=e.analysisName,o=e.mitoAPI,i=f(t,n);if(i){const[e]=i,t=function(e,t){const n=p(e);if(r(n)&&!c(n)){const o=m(n),i=n.lastIndexOf(")");let l="";return l=o.includes("sheet()")?`analysis_to_replay="${t}")`:`, analysis_to_replay="${t}")`,y(e,n.substring(0,i)+l+n.substring(i+1)),!0}return!1}(e,n);if(t)return}o.log("write_analysis_to_replay_to_mitosheet_call_failed")}}),e.commands.addCommand("mitosheet:overwrite-analysis-to-replay-to-mitosheet-call",{label:"Given an oldAnalysisName and newAnalysisName, writes the newAnalysisName to the mitosheet.sheet() call that has the oldAnalysisName.",execute:e=>{const n=e.oldAnalysisName,o=e.newAnalysisName,i=e.mitoAPI,l=v(t,n);if(void 0===l)return;const[s]=l,a=function(e,t,n){return!(!r(p(e))||!d(p(e),t))&&(y(e,p(e).replace(RegExp(`analysis_to_replay\\s*=\\s*"${t}"`),`analysis_to_replay="${n}"`)),!0)}(s,n,o);a||i.log("overwrite_analysis_to_replay_to_mitosheet_call_failed")}}),e.commands.addCommand("mitosheet:write-generated-code-cell",{label:"Writes the generated code for a mito analysis to the cell below the mitosheet.sheet() call that generated this analysis. NOTE: this should only be called after the analysis_to_replay has been written in the mitosheet.sheet() call, so this cell can be found correctly.",execute:e=>{var n,o,l;const a=e.analysisName,r=function(e,t,n,o){if(0==t.length)return"";let i="";return i=n?`register_analysis("${e}");`:`# Analysis Name:${e};`,t.join("\n").replace(`mitosheet.public.v${o} import *`,`mitosheet.public.v${o} import *; ${i}`)}(a,e.code,e.telemetryEnabled,e.publicInterfaceVersion),d=v(t,a);if(void 0===d)return;const[,c]=d,m=null===(n=t.currentWidget)||void 0===n?void 0:n.content,u=null===(o=null==m?void 0:m.model)||void 0===o?void 0:o.cells;if(void 0===m||void 0===u)return;const f=m.activeCellIndex,x=h(u,c+1);if(b(x)||function(e,t){return function(e){let t=!1;return s.forEach((n=>{(e.startsWith(n+"; register_analysis(")||e.startsWith(n+"; # Analysis Name:"))&&(t=!0)})),e.startsWith("# MITO CODE START")||e.startsWith("from mitosheet import *; register_analysis(")||e.startsWith("from mitosheet import *; # Analysis:")||e.startsWith("from mitosheet import *; # Analysis Name:")||t}(e)&&e.includes(t)}(p(x),a))y(x,r);else{if(c!==f)if(c<f)for(let e=0;e<f-c;e++)i.NotebookActions.selectAbove(m);else if(c>f)for(let e=0;e<c-f;e++)i.NotebookActions.selectBelow(m);i.NotebookActions.insertBelow(m),y(null===(l=null==m?void 0:m.activeCell)||void 0===l?void 0:l.model,r)}}}),e.commands.addCommand("mitosheet:write-code-snippet-cell",{label:"Writes the generated code for a mito analysis to the cell below the mitosheet.sheet() call that generated this analysis. NOTE: this should only be called after the analysis_to_replay has been written in the mitosheet.sheet() call, so this cell can be found correctly.",execute:e=>{var n,o,l;const s=e.analysisName,a=e.code,r=v(t,s);if(void 0===r)return;const[,d]=r,c=null===(n=t.currentWidget)||void 0===n?void 0:n.content,m=null===(o=null==c?void 0:c.model)||void 0===o?void 0:o.cells;if(void 0===c||void 0===m)return;const u=h(m,d+2);b(u)?y(u,a):(i.NotebookActions.selectBelow(c),i.NotebookActions.insertBelow(c),y(null===(l=null==c?void 0:c.activeCell)||void 0===l?void 0:l.model,a))}}),e.commands.addCommand("mitosheet:get-args",{label:"Reads the arguments passed to the mitosheet.sheet call.",execute:e=>{const n=e.analysisToReplayName,o=f(t,n);if(o){const[e]=o;return(e=>{let t=m(e).split("sheet(")[1].split(")")[0];t.includes("analysis_to_replay")&&(t=t.split("analysis_to_replay")[0].trim()),t.includes("view_df")&&(t=t.split("view_df")[0].trim()),t.includes("sheet_functions")&&(t=t.split("sheet_functions")[0].trim());let n=t.split(",").map((e=>e.trim()));return n=n.filter((e=>e.length>0)),n})(p(e))}return[]}}),e.commands.addCommand("mitosheet:create-mitosheet-from-dataframe-output",{label:"creates a new mitosheet from the dataframe that is printed",execute:async()=>{var e,n,o;const l=null===(e=t.currentWidget)||void 0===e?void 0:e.content,s=null===(n=t.currentWidget)||void 0===n?void 0:n.context;if(!l||!s)return;let r=a(p(null===(o=l.activeCell)||void 0===o?void 0:o.model));(null==r?void 0:r.endsWith(".head()"))&&(r=r.split(".head()")[0]),i.NotebookActions.clearOutputs(l),i.NotebookActions.insertBelow(l);const d=l.activeCell;y(null==d?void 0:d.model,`import mitosheet\nmitosheet.sheet(${r})`),i.NotebookActions.run(l,s.sessionContext)}}),e.commands.addCommand("mitosheet:create-empty-mitosheet",{label:"Creates a new empty mitosheet",execute:async()=>{var e,n;const o=null===(e=t.currentWidget)||void 0===e?void 0:e.content,l=null===(n=t.currentWidget)||void 0===n?void 0:n.context;if(!o||!l)return;i.NotebookActions.insertBelow(o);const s=o.activeCell;y(null==s?void 0:s.model,"import mitosheet\nmitosheet.sheet()"),i.NotebookActions.run(o,l.sessionContext)}}),e.commands.addKeyBinding({command:"mitosheet:focus-on-search",args:{},keys:["Accel F"],selector:".mito-container"}),e.commands.addCommand("mitosheet:focus-on-search",{label:"Focuses on search of the currently selected mito notebook",execute:async()=>{const e=u(),t=null==e?void 0:e.querySelector("#action-search-bar-id");null==t||t.focus()}}),e.commands.addKeyBinding({command:"mitosheet:mito-undo",args:{},keys:["Accel Z"],selector:".mito-container"}),e.commands.addCommand("mitosheet:mito-undo",{label:"Clicks the undo button once",execute:async()=>{var e,t;const n=u();if("input"===(null===(e=document.activeElement)||void 0===e?void 0:e.tagName.toLowerCase())||"textarea"===(null===(t=document.activeElement)||void 0===t?void 0:t.tagName.toLowerCase()))return;const o=null==n?void 0:n.querySelector("#mito-undo-button");null==o||o.click()}}),e.commands.addKeyBinding({command:"mitosheet:mito-redo",args:{},keys:["Accel Y"],selector:".mito-container"}),e.commands.addCommand("mitosheet:mito-redo",{label:"Clicks the redo button once",execute:async()=>{var e,t;const n=u();if("input"===(null===(e=document.activeElement)||void 0===e?void 0:e.tagName.toLowerCase())||"textarea"===(null===(t=document.activeElement)||void 0===t?void 0:t.tagName.toLowerCase()))return;const o=null==n?void 0:n.querySelector("#mito-redo-button");null==o||o.click()}}),e.commands.addKeyBinding({command:"mitosheet:do-nothing",args:{},keys:["Shift Enter"],selector:".mito-container"}),e.commands.addCommand("mitosheet:do-nothing",{label:"Does nothing",execute:async()=>{}}),window.commands=e.commands},autoStart:!0}},147:e=>{e.exports=JSON.parse('{"files":["lib/**/*.js","fonts/**/*","dist/*.js","css/**/*.css","style/index.js"],"jupyterlab":{"outputDir":"mitosheet/labextension","extension":"lib/plugin"},"name":"mitosheet","license":"AGPL-3.0-only","author":{"name":"Mito Sheet","email":"naterush1997@gmail.com"},"bugs":{"url":"https://github.com/mito-ds/monorepo/issues"},"repository":{"url":"https://github.com/mito-ds/monorepo","type":"git"},"version":"0.1.507","dependencies":{"@jupyterlab/application":"^3.5.0","@jupyterlab/notebook":"^3.0.6","@types/fscreen":"^1.0.1","@types/react-dom":"^17.0.2","fscreen":"^1.1.0","react":"^17.0.1","react-dom":"^17.0.1","streamlit-component-lib":"^2.0.0"},"scripts":{"clean:lib":"rimraf lib tsconfig.tsbuildinfo","clean:nbextension":"rimraf mitosheet/nbextension","clean:labextension":"rimraf mitosheet/labextension","clean:mito_frontend":"rimraf mitosheet/mito_frontend.js mitosheet/mito_frontend.css","clean:all":"jlpm run clean:lib && jlpm run clean:nbextension && jlpm run clean:labextension && jlpm run clean:mito_frontend","clean":"npm run clean:all","build:nbextension:dev":"webpack --mode=development","build:labextension:dev":"jupyter labextension build --development True .","build:mito_frontend:dev":"node esbuild.js","build:streamlit:dev":"node esbuild.streamlit.js","build:all:dev":"npm run build:nbextension:dev && build:labextension:dev && build:mito_frontend:dev && build:streamlit:dev","build:dev":"npm run build:all:dev","build:lib":"tsc","build:nbextension":"webpack --mode=production","build:labextension":"jupyter labextension build .","build:mito_frontend":"node esbuild.js","build:streamlit":"node esbuild.streamlit.js","build:all":"npm run build:lib && npm run build:labextension && npm run build:nbextension && npm run build:mito_frontend && npm run build:streamlit","build":"npm run build:all","watch:lib":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch .","watch:mito_frontend":"node esbuild.js --watch","watch:streamlit":"node esbuild.streamlit.js --watch","watch:all":"run-p watch:lib watch:labextension watch:nbextension watch:mito_frontend watch:streamlit","watch":"npm run watch:all","lint:check":"eslint src/ --ext .ts,.tsx","lint":"eslint src/ --ext .ts,.tsx --fix","prepare":"jlpm run clean && jlpm run build:all","prepack":"npm run build:all","build:docs:update_frontend":"python docs/make_function_docs.py update_frontend","build:docs:generate_markdown":"python docs/make_function_docs.py generate_markdown"},"keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets","ipython","ipywidgets"],"devDependencies":{"@jupyterlab/builder":"^3.0.0","@types/expect.js":"^0.3.29","@types/node":"^18.11.18","@types/react":"^17.0.26","@typescript-eslint/eslint-plugin":"^4.8.1","@typescript-eslint/parser":"^4.8.1","esbuild":"^0.15.16","eslint":"^7.14.0","eslint-config-prettier":"^8.3.0","eslint-plugin-office-addins":"^1.0.3","eslint-plugin-prettier":"^4.0.0","eslint-plugin-react":"^7.21.3","expect.js":"^0.3.1","fs-extra":"^10.0.0","mkdirp":"^1.0.4","mocha":"^9.1.2","npm-run-all":"^4.1.5","prettier":"^2.1.1","rimraf":"^3.0.2","typescript":"^4.4.3"},"main":"lib/index.js","homepage":"https://trymito.io","types":"./lib/index.d.ts","description":"The Mito Spreadsheet","resolutions":{"@types/react":"^17.0.2"}}')}}]);