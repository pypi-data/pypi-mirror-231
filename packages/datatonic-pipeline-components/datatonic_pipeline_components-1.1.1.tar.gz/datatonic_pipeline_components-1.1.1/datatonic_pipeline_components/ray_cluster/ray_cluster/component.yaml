# PIPELINE DEFINITION
# Name: ray-cluster
# Inputs:
#    cluster_op_timeout: int [Default: 300.0]
#    min_nodes: int [Default: 1.0]
#    node_config_cmd: str
#    nodes_alive_time: int [Default: 86400.0]
#    ray_task_cmd: str
#    retry_interval_ms: int [Default: 5000.0]
components:
  comp-ray-cluster:
    executorLabel: exec-ray-cluster
    inputDefinitions:
      parameters:
        cluster_op_timeout:
          defaultValue: 300.0
          description: ' Maximum timeout in seconds of any Ray cluster establish jobs.

            Defaults to 300.'
          isOptional: true
          parameterType: NUMBER_INTEGER
        min_nodes:
          defaultValue: 1.0
          description: The minimum nodes required in the Ray cluster. Defaults to
            1.
          isOptional: true
          parameterType: NUMBER_INTEGER
        node_config_cmd:
          description: 'Command for additional setup that will be executed on all
            nodes in the cluster.

            For example, installing the dependencies or cloning a codebase. Defaults
            to None.'
          isOptional: true
          parameterType: STRING
        nodes_alive_time:
          defaultValue: 86400.0
          description: The amount of time that a node is alive. Defaults to 24*60*60
            (1 day).
          isOptional: true
          parameterType: NUMBER_INTEGER
        ray_task_cmd:
          description: The command to run the Ray task(s).
          parameterType: STRING
        retry_interval_ms:
          defaultValue: 5000.0
          description: 'Retry interval in milliseconds of any Ray cluster establish
            jobs.

            Defaults to 5000.'
          isOptional: true
          parameterType: NUMBER_INTEGER
deploymentSpec:
  executors:
    exec-ray-cluster:
      container:
        args:
        - --executor_input
        - '{{$}}'
        - --function_to_execute
        - ray_cluster
        command:
        - python3
        - -m
        - kfp.components.executor_main
        image: dtpipelinecomponents/ray_cluster:v1.1.1
pipelineInfo:
  name: ray-cluster
root:
  dag:
    tasks:
      ray-cluster:
        cachingOptions:
          enableCache: true
        componentRef:
          name: comp-ray-cluster
        inputs:
          parameters:
            cluster_op_timeout:
              componentInputParameter: cluster_op_timeout
            min_nodes:
              componentInputParameter: min_nodes
            node_config_cmd:
              componentInputParameter: node_config_cmd
            nodes_alive_time:
              componentInputParameter: nodes_alive_time
            ray_task_cmd:
              componentInputParameter: ray_task_cmd
            retry_interval_ms:
              componentInputParameter: retry_interval_ms
        taskInfo:
          name: ray-cluster
  inputDefinitions:
    parameters:
      cluster_op_timeout:
        defaultValue: 300.0
        description: ' Maximum timeout in seconds of any Ray cluster establish jobs.

          Defaults to 300.'
        isOptional: true
        parameterType: NUMBER_INTEGER
      min_nodes:
        defaultValue: 1.0
        description: The minimum nodes required in the Ray cluster. Defaults to 1.
        isOptional: true
        parameterType: NUMBER_INTEGER
      node_config_cmd:
        description: 'Command for additional setup that will be executed on all nodes
          in the cluster.

          For example, installing the dependencies or cloning a codebase. Defaults
          to None.'
        isOptional: true
        parameterType: STRING
      nodes_alive_time:
        defaultValue: 86400.0
        description: The amount of time that a node is alive. Defaults to 24*60*60
          (1 day).
        isOptional: true
        parameterType: NUMBER_INTEGER
      ray_task_cmd:
        description: The command to run the Ray task(s).
        parameterType: STRING
      retry_interval_ms:
        defaultValue: 5000.0
        description: 'Retry interval in milliseconds of any Ray cluster establish
          jobs.

          Defaults to 5000.'
        isOptional: true
        parameterType: NUMBER_INTEGER
schemaVersion: 2.1.0
sdkVersion: kfp-2.0.1
