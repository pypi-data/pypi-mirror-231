[package]
name = "candle-nn"
version= "0.2.3"
edition= "2021"
description= "Minimalist ML framework."
repository= "https://github.com/huggingface/candle"
keywords= ["blas", "tensor", "machine-learning"]
categories= ["science"]
license= "MIT OR Apache-2.0"
readme = "README.md"
resolver = "2"

[dependencies]
candle = { path = "../candle", version = "0.2.3", package = "candle-core" }
accelerate-src = { version = "0.3.2" , optional = true }
half = { version = "2.3.1", features = ["num-traits", "use-intrinsics", "rand_distr"] }
thiserror = "1"
intel-mkl-src = { version = "0.8.1", features = ["mkl-static-lp64-iomp"] , optional = true }
num-traits = "0.2.15"
rayon = "1.7.0"
safetensors = "0.3.1"
serde = { version = "1.0.171", features = ["derive"] }

[features]
default = []
accelerate = ["dep:accelerate-src", "candle/accelerate"]
cuda = ["candle/cuda"]
mkl = ["dep:intel-mkl-src", "candle/mkl"]
