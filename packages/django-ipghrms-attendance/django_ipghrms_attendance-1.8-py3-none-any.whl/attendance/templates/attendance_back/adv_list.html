{% extends "main/layout.html" %}
{% load static %}
{% block content %}
<div class="breadcrumb-holder">
	<div class="container-fluid">
		<ul class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'attendance-dash' %}">PAINEL ABESENSIA</a></li>
			<li class="breadcrumb-item active" aria-current="page">{{ legend|upper }}</li>
		</ul>
	</div>
</div>
<div class="container-fluid"><br/>
	<div class="row">
		<div class="col-sm-12">
			<div class="card shadow-lg pt-1 border-primary rounded">
				<div class="card-header">{{ legend|upper }}</div>
				<div class="card-body">
                    <center><h1>{{ div.name|upper }}</h1>
                    <h3>Fulan {{ month.name }} Tinan {{ year }}</h3></center>
					<hr/>
					<p align="right">
					{% if att_div.is_confirm == False %}
						{% if not att_div.file %}
						<a class="btn btn-sm btn-danger" href="{% url 'attendance-upload' div.id att_div.year att_div.month  %}">Upload <i class="fa fa-upload"></i></a>
						{% else %}
						<a class="btn btn-sm btn-danger" href="{% url 'attendance-upload' div.id att_div.year att_div.month  %}">Altera File <i class="fa fa-upload"></i></a>
						<a class="btn btn-sm btn-danger" href="{% url 'attendance-pdf' att_div.id %}" target="_blank">Hare Absensia Original <i class="fa fa-file-pdf-o"></i></a>
						{% endif %}
						<a class="btn btn-sm btn-primary" href="{% url 'attendance-confirm' att_div.id %}">Konfirma <i class="fa fa-check"></i></a>
					{% elif att_div.is_confirm == True and att_div.is_final == False %}
						<a class="btn btn-sm btn-secondary" href="{% url 'attendance-cancel' att_div.id %}"><i class="fa fa-close"></i> Cancela</a>
						<a class="btn btn-sm btn-primary" href="{% url 'attendance-final-confirm' att_div.id %}">Konfirma Ikus <i class="fa fa-check"></i></a>
					{% elif att_div.is_final == True %}
						<a class="btn btn-sm btn-danger" href="{% url 'attendance-pdf' att_div.id %}" target="_blank">Hare Absensia Original <i class="fa fa-file-pdf-o"></i></a>
						<a class="btn btn-sm btn-secondary" href="{% url 'attendance-print' div.id %}" target="_blank">Print <i class="fa fa-print"></i></a>
					{% endif %}
					</p>
					<table class="table table-sm table-bordered">
                        <thead>
                            <tr><th>Nu</th>
                                <th>Pessoal</th>
                                <th>Oras</th>
							{% for i in days %}
								{% if i.2 == 0 %}<!--weekend-->
									{% if i.3 == 0 %}<!--holiday-->
										{% if i.1 == 0 %}
										<th>
										<a href="{% url 'attendance-adv-day' i.0 %}">{{ i.0 }}</a>
										</th>
										{% else %}
										<th>{{ i.0 }}</th>
										{% endif %}
									{% else %}
										<th class="bg-danger" style="color: white;">{{ i.0 }}</th>
									{% endif %}
								{% else %}
									<th class="bg-secondary">{{ i.0 }}</th>
								{% endif %}
							{% endfor %}
                            </tr>
                        </thead>
                    {% for obj in objects %}
                        <tr>
							<td rowspan="2">{{ forloop.counter }}</td>
                            <td rowspan="2"><a href="{% url 'attendance-adv-emp' obj.0.hashed %}">{{ obj.0 }}</a></td>
							<td>AM</td>
							{% for obj2 in obj.1 %}
							  {% if obj2.3 == 0 %} <!--weekend-->
								{% if obj2.4 == 0 %} <!--holiday-->
								<td>{{ obj2.1.code }}
									{% if obj2.0 %}
										{% if att_div.is_confirm == False %}
										<br/><a href="{% url 'attendance-process-am' obj2.0 %}"><i class="fa fa-edit"></i></a>
										{% endif %}
									{% endif %}</td>
								{% else %}
								<td class="bg-danger"></td>
								{% endif %}
							  {% else %}
								<td class="bg-secondary"></td>
							  {% endif %}
							{% endfor %}
                        </tr>
						<tr>
							<td>PM</td>
							{% for obj3 in obj.1 %} {{obj3.0.id}}
							  {% if obj3.3 == 0 %} <!--weekend-->
								{% if obj3.4 == 0 %} <!--holiday-->
								<td>{{ obj3.2.code }} 
									{% if obj3.0 %}
										{% if att_div.is_confirm == False %}
										<br/><a href="{% url 'attendance-process-pm' obj3.0 %}"><i class="fa fa-edit"></i></a>
										{% endif %}
									{% endif %}</td>							
								{% else %}
									<td class="bg-danger"></td>
								{% endif %}
							  {% else %}
								<td class="bg-secondary"></td>
							  {% endif %}
							{% endfor %}
						</tr>
                    {% endfor %}
                    </table>
				</div> <!--end card-body-->
			</div> <!--end card-->
		</div> <!--end col-->
	</div> <!--end row-->
</div> <!--end container-->
{% endblock %}
{% block scripts %}
{% endblock %}