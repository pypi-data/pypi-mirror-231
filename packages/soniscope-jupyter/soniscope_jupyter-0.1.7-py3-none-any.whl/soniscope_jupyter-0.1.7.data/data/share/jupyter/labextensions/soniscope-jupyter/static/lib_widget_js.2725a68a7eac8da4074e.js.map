{"version":3,"file":"lib_widget_js.2725a68a7eac8da4074e.js","mappings":";;;;;;;;;;;;;;;;;AAAA;AAC0G;AACjB;AACzF,8BAA8B,mFAA2B,CAAC,4FAAqC;AAC/F;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B;AAC5B,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,iFAAiF,YAAY,aAAa,OAAO,KAAK,UAAU,YAAY,WAAW,OAAO,KAAK,UAAU,YAAY,WAAW,OAAO,KAAK,YAAY,OAAO,KAAK,YAAY,WAAW,YAAY,aAAa,OAAO,KAAK,UAAU,UAAU,YAAY,aAAa,OAAO,KAAK,UAAU,YAAY,WAAW,yCAAyC,oCAAoC,qBAAqB,GAAG,uBAAuB,oBAAoB,4BAA4B,mBAAmB,GAAG,sBAAsB,oBAAoB,4BAA4B,mBAAmB,GAAG,gBAAgB,yBAAyB,GAAG,qBAAqB,wBAAwB,eAAe,sBAAsB,0BAA0B,GAAG,oBAAoB,iBAAiB,kBAAkB,8BAA8B,qBAAqB,KAAK,yBAAyB,iBAAiB,yBAAyB,eAAe,GAAG,qBAAqB;AACvhC;AACA,iEAAe,uBAAuB,EAAC;;;;;;;;;;;;;AC/CvC,mDAAmD;AACnD,oEAAoE;;;;;;;;;;;;;;;;;;;;;;AAGpE,gGAAyB;AAEzB,MAAM,eAAe,GAAG,GAAG,CAAC;AAE5B,MAAa,UAAU;IAYrB,YACE,IAAmB,EACnB,KAA+C;QARzC,gBAAW,GAAG,GAAG,CAAC;QAClB,YAAO,GAAG,EAAE,CAAC;QACd,cAAS,GAAG,CAAC,CAAS,EAAE,CAAS,EAA4B,EAAE;YACpE,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;QAClB,CAAC,CAAC;QAMA,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QAEjB,sEAAsE;QACtE,IAAI,CAAC,MAAM;YACT,MAAM,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,mBAAmB,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QAE3E,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;aACpB,MAAM,CAAC,KAAK,CAAC;aACb,MAAM,CAAC,MAAM,CAAC;aACd,MAAM,CAAC,UAAU,CAAC;aAClB,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QAE3B,IAAI,CAAC,OAAO,GAAG,KAAK;aACjB,MAAM,CAAC,GAAG,CAAC;aACX,IAAI,CAAC,WAAW,EAAE,QAAQ,IAAI,CAAC,MAAM,GAAG,CAAC;YAC1C,0CAA0C;aACzC,MAAM,CAAC,GAAG,CAAC;aACX,OAAO,CAAC,aAAa,EAAE,IAAI,CAAC;aAC5B,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC;aACnB,IAAI,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC;QACxC,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,cAAc,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QAE5E,mEAAmE;QACnE,IAAI,CAAC,UAAU,GAAG,KAAK;aACpB,MAAM,CAAC,MAAM,CAAC;aACd,OAAO,CAAC,gBAAgB,EAAE,IAAI,CAAC;aAC/B,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;YACb,uDAAuD;aACtD,EAAE,CAAC,YAAY,EAAE,GAAG,EAAE;YACrB,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;QACjD,CAAC,CAAC;aACD,EAAE,CAAC,YAAY,EAAE,GAAG,EAAE;YACrB,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;QACnC,CAAC,CAAC;aACD,EAAE,CACD,OAAO,EACP,CAAC,GAAe,EAAE,EAAE;YAClB,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,GAAG,CAAC,eAAe,EAAE,CAAC;YACtB,gDAAgD;YAChD,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAW,CAAC;YAC1D,MAAM,cAAc,GAClB,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC;YAClD,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC,CAAC;YAClE,sCAAsC;YACtC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;YACzC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC;YAC/B,OAAO,KAAK,CAAC;QACf,CAAC,EACD,EAAE,OAAO,EAAE,KAAK,EAAE,CACnB;aACA,EAAE,CAAC,WAAW,EAAE,CAAC,GAAe,EAAE,EAAE;YACnC,MAAM,IAAI,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,IAAI,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YAChC,4CAA4C;YAC5C,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,aAAa,IAAI,KAAK,IAAI,GAAG,CAAC,CAAC;QAChE,CAAC,CAAC;aACD,EAAE,CAAC,WAAW,EAAE,GAAG,EAAE;YACpB,IAAI,CAAC,IAAI,CAAC;gBACR,KAAK,EAAE,eAAe;aACvB,CAAC,CAAC;QACL,CAAC,CAAC;aACD,EAAE,CAAC,UAAU,EAAE,GAAG,EAAE;YACnB,gBAAgB;YAChB,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;QAC9D,CAAC,CAAC;aACD,EAAE,CAAC,sBAAsB,EAAE,CAAC,GAAY,EAAE,EAAE;YAC3C,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,6BAA6B;YAC7B,IAAI,IAAI,GAAG,CAAC,CAAC,CAAC;YACd,IAAI,IAAI,GAAG,CAAC,CAAC,CAAC;YACd,IAAI,GAAG,CAAC,IAAI,KAAK,YAAY,EAAE;gBAC7B,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC9B,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aAC/B;iBAAM,IAAI,GAAG,CAAC,IAAI,KAAK,WAAW,EAAE;gBACnC,IAAI,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC1B,IAAI,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAC3B;YACD,IAAI,IAAI,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,EAAE;gBACxB,OAAO;aACR;YACD,gDAAgD;YAChD,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YAC1C,uBAAuB;YAEvB,oCAAoC;YACpC,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC;YAExE,IAAI,CAAC,IAAI,+BACP,KAAK,EAAE,MAAM,IACV,MAAM,KACT,KAAK,EAAE,MAAM,CAAC,CAAC,EACf,KAAK,EAAE,MAAM,CAAC,CAAC,IACf,CAAC;YAEH,uBAAuB;YACvB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,aAAa,IAAI,KAAK,IAAI,GAAG,CAAC,CAAC;YAE9D,yCAAyC;YACzC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;QAEL,+FAA+F;QAE/F,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAChB,gDAAgD,EAChD,GAAG,EAAE,CAAC,IAAI,CAAC,mBAAmB,EAAE,EAChC,IAAI,CAAC,IAAI,CACV,CAAC;QAEF,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,aAAa,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5E,CAAC;IAEO,mBAAmB;QACzB,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAW,CAAC;QACpE,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,kBAAkB,CAAW,CAAC;QACtE,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;QAC1C,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;QAE5C,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;aACpB,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC;aACzB,IAAI,CACH,4BAA4B,UAAU,aAAa,WAAW,MAAM,CACrE,CAAC;QAEJ,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;QAErD,IAAI,CAAC,cAAc,EAAE,CAAC;IACxB,CAAC;IAEO,cAAc;QACpB,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAW,CAAC;QACvD,mDAAmD;QACnD,IAAI,CAAC,OAAO,GAAG,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,GAAG,CAAC;QACnD,wCAAwC;QACxC,4CAA4C;QAC5C,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IAC1E,CAAC;IAEO,eAAe;QACrB,2BAA2B;QAC3B,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,QAAQ,EAAE;YAC7C,IAAI,CAAC,OAAO,CAAC,IAAI,CACf,iDAAiD,IAAI,CAAC,OAAO,MAAM,CACpE,CAAC;SACH;aAAM,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,QAAQ,EAAE;YACpD,IAAI,CAAC,OAAO,CAAC,IAAI,CACf,6DAA6D,IAAI,CAAC,OAAO,MAAM,CAChF,CAAC;SACH;aAAM,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,OAAO,EAAE;YACnD,IAAI,CAAC,OAAO,CAAC,IAAI,CACf,qEAAqE,IAAI,CAAC,OAAO,MAAM,CACxF,CAAC;SACH;aAAM,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,OAAO,EAAE;YACnD,IAAI,CAAC,OAAO,CAAC,IAAI,CACf,qEAAqE,IAAI,CAAC,OAAO,MAAM,CACxF,CAAC;SACH;aAAM,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,MAAM,EAAE;YAClD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACvB;IACH,CAAC;CACF;AApLD,gCAoLC;AAED,SAAgB,gBAAgB,CAC9B,KAA+C;IAE/C,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,MAAM,EAAE,CAAC;AACtC,CAAC;AAJD,4CAIC;;;;;;;;;;;;;AClMD,mDAAmD;AACnD,oEAAoE;;;;;;;;;;;;;;;;;;;;;;AAGpE,gGAAyB;AACzB,oFAA0C;AAE1C,MAAM,MAAM,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AAC5D,MAAM,WAAW,GAAG,CAAC,CAAC;AAEtB,MAAa,WAAW;IAItB,YAAY,IAAmB;QAC7B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QAEjB,MAAM,CAAC,GAAG,EAAE;aACT,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;aACf,MAAM,CAAC,KAAK,CAAC;aACb,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC;aAClB,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC;aACnB,MAAM,CAAC,GAAG,CAAC;aACX,OAAO,CAAC,WAAW,EAAE,IAAI,CAAC;aAC1B,IAAI,CAAC,WAAW,EAAE,YAAY,GAAG,MAAM,CAAC,IAAI,GAAG,GAAG,GAAG,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;QAE1E,kDAAkD;QAClD,MAAM,CAAC,GAAG,YAAY,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;QACrC,MAAM,CAAC,GAAG,YAAY,CAAC,EAAE,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;QAErC,iBAAiB;QACjB,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC;aACV,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC;aACvB,IAAI,CAAC,WAAW,EAAE,cAAc,GAAG,GAAG,GAAG,GAAG,CAAC;aAC7C,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QAE1B,iBAAiB;QACjB,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QAE3D,uBAAuB;QACvB,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC;aACV,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC;aACpB,MAAM,CAAC,MAAM,CAAC;aACd,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC;aACtB,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAE/B,IAAI,CAAC,UAAU,GAAG,IAAI,uBAAU,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAE1C,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAChB,gDAAgD,EAChD,GAAG,EAAE,CAAC,IAAI,CAAC,mBAAmB,EAAE,EAChC,IAAI,CAAC,IAAI,CACV,CAAC;QACF,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAChB,qDAAqD,EACrD,IAAI,CAAC,qBAAqB,EAC1B,IAAI,CACL,CAAC;IACJ,CAAC;IAEO,mBAAmB;QACzB,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAW,CAAC;QACpE,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,kBAAkB,CAAW,CAAC;QAEtE,MAAM,MAAM,GAAG,EAAE;aACd,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;aACpB,MAAM,CAAC,KAAK,CAAC;aACb,IAAI,CAAC,OAAO,EAAE,UAAU,GAAG,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC;aACtD,IAAI,CAAC,QAAQ,EAAE,WAAW,GAAG,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;QAE5D,MAAM;aACH,MAAM,CAAC,SAAS,CAAC;aACjB,IAAI,CAAC,WAAW,EAAE,cAAc,GAAG,WAAW,GAAG,GAAG,CAAC,CAAC;QAEzD,MAAM;aACH,MAAM,CAAC,SAAS,CAAC;aACjB,IAAI,CAAC,WAAW,EAAE,YAAY,GAAG,CAAC,UAAU,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,CAAC;QAE3E,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC/B,CAAC;IAEM,qBAAqB;QAC1B,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,iBAAiB,CAAW,CAAC;QACpE,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,kBAAkB,CAAW,CAAC;QAEtE,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAa,CAAC;QAC5D,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAa,CAAC;QAC5D,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,cAAc,CAAa,CAAC;QAEhE,iBAAiB;QACjB,MAAM,MAAM,GAAG,YAAY,CAAC,OAAO,EAAE,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;QACtD,MAAM,MAAM,GAAG,YAAY,CAAC,OAAO,EAAE,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;QACvD,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,CAAC,CAAS,EAAE,CAAS,EAAE,EAAE;YACnD,OAAO,EAAE,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC;QACtD,CAAC,CAAC;QAEF,6CAA6C;QAC7C,MAAM,WAAW,GAAG,EAAE;aACnB,OAAO,CACN,OAAO,EACP,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,EACf,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CACT;aACA,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aACtC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACpB,4BAA4B;QAC5B,wCAAwC;QAExC,MAAM,UAAU,GAAG,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QAE3E,6EAA6E;QAE7E,MAAM,UAAU,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;QAEjE,mDAAmD;QACnD,iDAAiD;QACjD,UAAU;aACP,SAAS,CAAC,YAAY,CAAC;aACvB,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC;aACzD,IAAI,CAAC,QAAQ,CAAC;aACd,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC;aACpB,IAAI,CAAC,GAAG,EAAE,WAAW,CAAC;aACtB,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;aAC9C,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;aACxC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAE5C,oBAAoB;QACpB,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,MAAM,CAAQ,CAAC,CAAC;QAChE,UAAU;aACP,SAAS,CAAC,UAAU,CAAC;aACrB,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;aACtC,IAAI,CAAC,MAAM,CAAC;aACZ,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC;YACzB,oCAAoC;aACnC,IAAI,CAAC,GAAG,EAAE,WAAW,GAAG,EAAE,CAAC;aAC3B,IAAI,CAAC,GAAG,EAAE,UAAU,GAAG,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC;aACxC,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC;aAC3B,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;QAElB,oBAAoB;QACpB,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAQ,CAAC,CAAC;QAC9D,UAAU;aACP,SAAS,CAAC,UAAU,CAAC;aACrB,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;aACtC,IAAI,CAAC,MAAM,CAAC;aACZ,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC;YACzB,oCAAoC;aACnC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;aACb,IAAI,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC;aACvB,KAAK,CAAC,aAAa,EAAE,OAAO,CAAC;aAC7B,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;QAElB,oBAAoB;QACpB,MAAM,OAAO,GAAG,UAAU,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QAC9C,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC;QAEtE,OAAO;aACJ,SAAS,CAAC,WAAW,CAAC;aACtB,IAAI,CAAC,WAAW,CAAC;aACjB,IAAI,CAAC,MAAM,CAAC;aACZ,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC;aACrB,IAAI,CAAC,CAAC,CAAS,EAAE,EAAE,CAAC,CAAC,CAAC;aACtB,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC;aAC3B,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC;aACf,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;QAEpC,OAAO;aACJ,SAAS,CAAC,MAAM,CAAC;aACjB,IAAI,CAAC,WAAW,CAAC;aACjB,IAAI,CAAC,MAAM,CAAC;aACZ,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC;aACf,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;aAC/B,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC;aAClB,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC;aACnB,KAAK,CAAC,MAAM,EAAE,CAAC,CAAS,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;IACjD,CAAC;CACF;AAvKD,kCAuKC;AAED,SAAS,YAAY,CACnB,MAAgB,EAChB,KAAuB;IAEvB,MAAM,IAAI,GAAG,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACjC,MAAM,IAAI,GAAG,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACjC,0DAA0D;IAC1D,MAAM,KAAK,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC;IACnC,MAAM,UAAU,GAAG,IAAI,GAAG,KAAK,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,KAAK,CAAC;IACpE,OAAO,EAAE;SACN,WAAW,EAAE;SACb,KAAK,CAAC,KAAK,CAAC;SACZ,MAAM,CAAC,CAAC,UAAU,EAAE,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC;AACxC,CAAC;;;;;;;;;;;;;AChMD,mDAAmD;AACnD,oEAAoE;;;AAEpE,6DAA6D;AAC7D,aAAa;AACb,8DAA8D;AAC9D,MAAM,IAAI,GAAG,mBAAO,CAAC,uCAAiB,CAAC,CAAC;AAExC;;;;;GAKG;AACU,sBAAc,GAAG,IAAI,CAAC,OAAO,CAAC;AAE3C;;GAEG;AACU,mBAAW,GAAG,IAAI,CAAC,IAAI,CAAC;;;;;;;;;;;;;ACnBrC,mDAAmD;AACnD,oEAAoE;;;AAEpE,yHAI+B;AAE/B,2EAAwD;AAExD,iBAAiB;AACjB,iEAA2B;AAC3B,uFAA4C;AAE5C,MAAa,SAAU,SAAQ,qBAAc;IAC3C,QAAQ;QACN,uCACK,KAAK,CAAC,QAAQ,EAAE,KACnB,WAAW,EAAE,SAAS,CAAC,UAAU,EACjC,aAAa,EAAE,SAAS,CAAC,YAAY,EACrC,qBAAqB,EAAE,SAAS,CAAC,oBAAoB,EACrD,UAAU,EAAE,SAAS,CAAC,SAAS,EAC/B,YAAY,EAAE,SAAS,CAAC,WAAW,EACnC,oBAAoB,EAAE,SAAS,CAAC,mBAAmB,EAEnD,OAAO,EAAE,EAAE,EACX,OAAO,EAAE,EAAE,EACX,QAAQ,EAAE,EAAc,EACxB,QAAQ,EAAE,EAAc,EACxB,IAAI,EAAE,GAAG,EACT,KAAK,EAAE,QAAQ,EACf,KAAK,EAAE,GAAG,EACV,MAAM,EAAE,GAAG,IACX;IACJ,CAAC;;AApBH,8BAiCC;AAXQ,qBAAW,qBACb,qBAAc,CAAC,WAAW,EAE7B;AAEK,oBAAU,GAAG,WAAW,CAAC;AACzB,sBAAY,GAAG,qBAAW,CAAC;AAC3B,8BAAoB,GAAG,wBAAc,CAAC;AACtC,mBAAS,GAAG,UAAU,CAAC,CAAC,yBAAyB;AACjD,qBAAW,GAAG,qBAAW,CAAC,CAAC,yBAAyB;AACpD,6BAAmB,GAAG,wBAAc,CAAC;AAG9C,MAAa,QAAS,SAAQ,oBAAa;IACzC,oCAAoC;IAEpC,MAAM;QACJ,qBAAqB;QACrB,IAAI,yBAAW,CAAC,IAAI,CAAC,CAAC;IACxB,CAAC;CACF;AAPD,4BAOC;;;;;;;;;;;;ACzDY;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA,gDAAgD;AAChD;AACA;AACA,qFAAqF;AACrF;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,iBAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,qBAAqB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,sFAAsF,qBAAqB;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,iDAAiD,qBAAqB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,sDAAsD,qBAAqB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACpFa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,cAAc;AACrE;AACA;AACA;AACA;AACA;;;;;;;;;;;ACfa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,wDAAwD;;AAExD;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;;AAEA,kBAAkB,wBAAwB;AAC1C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,kBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gBAAgB,KAAwC,GAAG,sBAAiB,GAAG,CAAI;;AAEnF;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,qEAAqE,qBAAqB,cAAc;;AAExG;;AAEA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA,yDAAyD;AACzD,IAAI;;AAEJ;;;AAGA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,oBAAoB,4BAA4B;AAChD;AACA;AACA;AACA;;AAEA;;AAEA,qBAAqB,6BAA6B;AAClD;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;AC5QA,UAAU,mBAAO,CAAC,oJAAwE;AAC1F,0BAA0B,mBAAO,CAAC,qHAAuD;;AAEzF;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;;AAIA","sources":["webpack://soniscope-jupyter/./css/widget.css","webpack://soniscope-jupyter/./src/lensCursor.ts","webpack://soniscope-jupyter/./src/scatterPlot.ts","webpack://soniscope-jupyter/./src/version.ts","webpack://soniscope-jupyter/./src/widget.ts","webpack://soniscope-jupyter/./node_modules/css-loader/dist/runtime/api.js","webpack://soniscope-jupyter/./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://soniscope-jupyter/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://soniscope-jupyter/./css/widget.css?a195"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.custom-widget {\n  background-color: lightseagreen;\n  padding: 0px 2px;\n}\n\n.substrate .label {\n  font-size: 10px;\n  font-family: sans-serif;\n  color: #404040;\n}\n\n.substrate .axis {\n  font-size: 10px;\n  font-family: sans-serif;\n  color: #404040;\n}\n\n.substrate {\n  pointer-events: none;\n}\n\n.cursor.overlay {\n  pointer-events: all;\n  fill: none;\n  cursor: crosshair;\n  shape-rendering: auto;\n}\n\n.cursor.lens * {\n  stroke: none;\n  fill: #3f3f3f;\n  /* fill: rgb(0, 0, 165);  */\n  /* opacity: 0; */\n}\n\n.cursor.lens.active {\n  stroke: none;\n  fill: rgb(165, 0, 0);\n  opacity: 0;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./css/widget.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,+BAA+B;EAC/B,gBAAgB;AAClB;;AAEA;EACE,eAAe;EACf,uBAAuB;EACvB,cAAc;AAChB;;AAEA;EACE,eAAe;EACf,uBAAuB;EACvB,cAAc;AAChB;;AAEA;EACE,oBAAoB;AACtB;;AAEA;EACE,mBAAmB;EACnB,UAAU;EACV,iBAAiB;EACjB,qBAAqB;AACvB;;AAEA;EACE,YAAY;EACZ,aAAa;EACb,2BAA2B;EAC3B,gBAAgB;AAClB;;AAEA;EACE,YAAY;EACZ,oBAAoB;EACpB,UAAU;AACZ\",\"sourcesContent\":[\".custom-widget {\\n  background-color: lightseagreen;\\n  padding: 0px 2px;\\n}\\n\\n.substrate .label {\\n  font-size: 10px;\\n  font-family: sans-serif;\\n  color: #404040;\\n}\\n\\n.substrate .axis {\\n  font-size: 10px;\\n  font-family: sans-serif;\\n  color: #404040;\\n}\\n\\n.substrate {\\n  pointer-events: none;\\n}\\n\\n.cursor.overlay {\\n  pointer-events: all;\\n  fill: none;\\n  cursor: crosshair;\\n  shape-rendering: auto;\\n}\\n\\n.cursor.lens * {\\n  stroke: none;\\n  fill: #3f3f3f;\\n  /* fill: rgb(0, 0, 165);  */\\n  /* opacity: 0; */\\n}\\n\\n.cursor.lens.active {\\n  stroke: none;\\n  fill: rgb(165, 0, 0);\\n  opacity: 0;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Copyright (c) Alexander Rind & the SoniVis team.\n// Distributed under the terms of the MIT License (see LICENSE.txt).\n\nimport { DOMWidgetView } from '@jupyter-widgets/base';\nimport * as d3 from 'd3';\n\nconst DEFAULT_OPACITY = 0.3;\n\nexport class LensCursor {\n  private view: DOMWidgetView;\n  private selLens: any;\n  private selOverlay: any;\n  private clipId: string;\n\n  private smallerSize = 100;\n  private rPixels = 10;\n  public transform = (x: number, y: number): { x: number; y: number } => {\n    return { x, y };\n  };\n\n  constructor(\n    view: DOMWidgetView,\n    gPlot: d3.Selection<SVGGElement, any, any, any>\n  ) {\n    this.view = view;\n\n    // prepare a clip-path, which will be defined in updateSubstrateSize()\n    this.clipId =\n      'clip' + (Math.random().toString(36) + '00000000000000000').slice(2, 14);\n\n    d3.select(this.view.el)\n      .select('svg')\n      .append('defs')\n      .append('clipPath')\n      .attr('id', this.clipId);\n\n    this.selLens = gPlot\n      .append('g')\n      .attr('clip-path', `url(#${this.clipId})`)\n      // clipping must happen before translation\n      .append('g')\n      .classed('cursor lens', true)\n      .style('opacity', 0)\n      .attr('transform', 'translate(0, 0)');\n    this.updateLensShape();\n    this.view.model.on('change:shape', () => this.updateLensShape(), this.view);\n\n    // add invisible rect to track mouse position (as last svg element)\n    this.selOverlay = gPlot\n      .append('rect')\n      .classed('cursor overlay', true)\n      .attr('x', 0)\n      // .on('touchstart', (event) => event.preventDefault())\n      .on('mouseenter', () => {\n        this.selLens.style('opacity', DEFAULT_OPACITY);\n      })\n      .on('mouseleave', () => {\n        this.selLens.style('opacity', 0);\n      })\n      .on(\n        'wheel',\n        (evt: WheelEvent) => {\n          evt.preventDefault();\n          evt.stopPropagation();\n          // TODO prevent screen from scrolling on Firefox\n          const oldLensSize = this.view.model.get('size') as number;\n          const scaledLensSize =\n            oldLensSize * Math.pow(1.25, evt.deltaY / -100);\n          const newLensSize = Math.min(1.5, Math.max(0.01, scaledLensSize));\n          // console.log('g', evt, newLensSize);\n          this.view.model.set('size', newLensSize);\n          this.view.model.save_changes();\n          return false;\n        },\n        { passive: false }\n      )\n      .on('mousemove', (evt: MouseEvent) => {\n        const rawX = d3.pointer(evt)[0];\n        const rawY = d3.pointer(evt)[1];\n        // circle.attr('cx', rawX).attr('cy', rawY);\n        this.selLens.attr('transform', `translate(${rawX}, ${rawY})`);\n      })\n      .on('pointerup mouseleave', () => {\n        view.send({\n          event: 'lens_released',\n        });\n      })\n      .on('touchend', () => {\n        // lens fade out\n        this.selLens.transition().duration(800).style('opacity', 0);\n      })\n      .on('mousedown touchstart', (evt: UIEvent) => {\n        evt.preventDefault();\n        // recover coordinate we need\n        let rawX = -1;\n        let rawY = -1;\n        if (evt.type === 'touchstart') {\n          rawX = d3.pointers(evt)[0][0];\n          rawY = d3.pointers(evt)[0][1];\n        } else if (evt.type === 'mousedown') {\n          rawX = d3.pointer(evt)[0];\n          rawY = d3.pointer(evt)[1];\n        }\n        if (rawX < 0 || rawY < 0) {\n          return;\n        }\n        // delegate coordinate transformations to caller\n        const center = this.transform(rawX, rawY);\n        // console.log(center);\n\n        // TODO assumption of a linear scale\n        const corner = this.transform(rawX + this.rPixels, rawY - this.rPixels);\n\n        view.send({\n          event: 'lens',\n          ...center,\n          edgeX: corner.x,\n          edgeY: corner.y,\n        });\n\n        // lens positioned here\n        this.selLens.attr('transform', `translate(${rawX}, ${rawY})`);\n\n        // lens visible (fade out after touchend)\n        this.selLens.style('opacity', DEFAULT_OPACITY);\n      });\n\n    // TODO change lense size by multi-touch cp. <https://observablehq.com/@d3/multitouch#cell-308>\n\n    this.updateSubstrateSize();\n    this.view.model.on(\n      'change:substrate_width change:substrate_height',\n      () => this.updateSubstrateSize(),\n      this.view\n    );\n\n    this.updateLensSize();\n    this.view.model.on('change:size', () => this.updateLensSize(), this.view);\n  }\n\n  private updateSubstrateSize() {\n    const substWidth = this.view.model.get('substrate_width') as number;\n    const substHeight = this.view.model.get('substrate_height') as number;\n    this.selOverlay.attr('width', substWidth);\n    this.selOverlay.attr('height', substHeight);\n\n    d3.select(this.view.el)\n      .select('#' + this.clipId)\n      .html(\n        `<rect x=\"0\" y=\"0\" width=\"${substWidth}\" height=\"${substHeight}\" />`\n      );\n\n    this.smallerSize = Math.min(substWidth, substHeight);\n\n    this.updateLensSize();\n  }\n\n  private updateLensSize() {\n    const lensSize = this.view.model.get('size') as number;\n    // console.log('client swidth ', this.smallerSize);\n    this.rPixels = (lensSize * this.smallerSize) / 2.0;\n    // this.selLens.attr('r', this.rPixels);\n    // console.log(this.selLens.selectAll('*'));\n    this.selLens.selectAll('*').attr('transform', `scale(${this.rPixels})`);\n  }\n\n  private updateLensShape() {\n    //   this.selLens.html('');\n    if (this.view.model.get('shape') === 'circle') {\n      this.selLens.html(\n        `<circle r=\"1\" cx=\"0\", cy=\"0\" transform=\"scale(${this.rPixels})\"/>`\n      );\n    } else if (this.view.model.get('shape') === 'square') {\n      this.selLens.html(\n        `<rect x=\"-1\" y=\"-1\" width=\"2\" height=\"2\" transform=\"scale(${this.rPixels})\"/>`\n      );\n    } else if (this.view.model.get('shape') === 'xonly') {\n      this.selLens.html(\n        `<rect x=\"-1\" y=\"-40000\" width=\"2\" height=\"80000\" transform=\"scale(${this.rPixels})\"/>`\n      );\n    } else if (this.view.model.get('shape') === 'yonly') {\n      this.selLens.html(\n        `<rect x=\"-40000\" y=\"-1\" width=\"80000\" height=\"2\" transform=\"scale(${this.rPixels})\"/>`\n      );\n    } else if (this.view.model.get('shape') === 'none') {\n      this.selLens.html('');\n    }\n  }\n}\n\nexport function removeLensCursor(\n  gPlot: d3.Selection<d3.BaseType, any, any, any>\n): void {\n  gPlot.selectAll('.cursor').remove();\n}\n","// Copyright (c) Alexander Rind & the SoniVis team.\n// Distributed under the terms of the MIT License (see LICENSE.txt).\n\nimport { DOMWidgetView } from '@jupyter-widgets/base';\nimport * as d3 from 'd3';\nimport { LensCursor } from './lensCursor';\n\nconst MARGIN = { top: 18, right: 30, bottom: 30, left: 30 };\nconst MARK_RADIUS = 2;\n\nexport class ScatterPlot {\n  private view: DOMWidgetView;\n  private lensCursor;\n\n  constructor(view: DOMWidgetView) {\n    this.view = view;\n\n    const g = d3\n      .select(view.el)\n      .append('svg')\n      .attr('width', 100)\n      .attr('height', 100)\n      .append('g')\n      .classed('substrate', true)\n      .attr('transform', 'translate(' + MARGIN.left + ',' + MARGIN.top + ')');\n\n    // get some temporary scales just for showing axes\n    const x = prepareScale([], [0, 100]);\n    const y = prepareScale([], [100, 0]);\n\n    // add the X Axis\n    g.append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,' + 100 + ')')\n      .call(d3.axisBottom(x));\n\n    // add the Y axis\n    g.append('g').attr('class', 'y axis').call(d3.axisLeft(y));\n\n    // add the color legend\n    g.append('g')\n      .attr('id', 'legend')\n      .append('text')\n      .classed('label', true)\n      .style('text-anchor', 'end');\n\n    this.lensCursor = new LensCursor(view, g);\n\n    this.updateSubstrateSize();\n    this.view.model.on(\n      'change:substrate_width change:substrate_height',\n      () => this.updateSubstrateSize(),\n      this.view\n    );\n    this.view.model.on(\n      'change:_marks_x change:_marks_y change:_marks_color',\n      this.updateScatterPlotData,\n      this\n    );\n  }\n\n  private updateSubstrateSize() {\n    const substWidth = this.view.model.get('substrate_width') as number;\n    const substHeight = this.view.model.get('substrate_height') as number;\n\n    const selSvg = d3\n      .select(this.view.el)\n      .select('svg')\n      .attr('width', substWidth + MARGIN.left + MARGIN.right)\n      .attr('height', substHeight + MARGIN.top + MARGIN.bottom);\n\n    selSvg\n      .select('.x.axis')\n      .attr('transform', 'translate(0,' + substHeight + ')');\n\n    selSvg\n      .select('#legend')\n      .attr('transform', 'translate(' + (substWidth + MARGIN.right) + ', -2)');\n\n    this.updateScatterPlotData();\n  }\n\n  public updateScatterPlotData(): void {\n    const substWidth = this.view.model.get('substrate_width') as number;\n    const substHeight = this.view.model.get('substrate_height') as number;\n\n    const xValues = this.view.model.get('_marks_x') as number[];\n    const yValues = this.view.model.get('_marks_y') as number[];\n    const cValues = this.view.model.get('_marks_color') as string[];\n\n    // set the scales\n    const xScale = prepareScale(xValues, [0, substWidth]);\n    const yScale = prepareScale(yValues, [substHeight, 0]);\n    this.lensCursor.transform = (x: number, y: number) => {\n      return { x: xScale.invert(x), y: yScale.invert(y) };\n    };\n\n    // const colorValues = [...new Set(cValues)];\n    const colorValues = d3\n      .rollups(\n        cValues,\n        (v) => v.length,\n        (d) => d\n      )\n      .sort((a, b) => (a[1] < b[1] ? 1 : -1))\n      .map((v) => v[0]);\n    // console.log(colorValues);\n    // a.last_nom.localeCompare(b.last_nom))\n\n    const colorScale = d3.scaleOrdinal(d3.schemeTableau10).domain(colorValues);\n\n    // console.log('%% length x: ' + xValues.length + ' , y: ' + yValues.length);\n\n    const gSubstrate = d3.select(this.view.el).select('g.substrate');\n\n    // add the scatterplot without data transformations\n    // <https://stackoverflow.com/a/17872039/1140589>\n    gSubstrate\n      .selectAll('circle.dot')\n      .data(xValues.length < yValues.length ? xValues : yValues)\n      .join('circle')\n      .classed('dot', true)\n      .attr('r', MARK_RADIUS)\n      .attr('fill', (d, i) => colorScale(cValues[i]))\n      .attr('cx', (d, i) => xScale(xValues[i]))\n      .attr('cy', (d, i) => yScale(yValues[i]));\n\n    // update the X Axis\n    gSubstrate.select('.x.axis').call(d3.axisBottom(xScale) as any);\n    gSubstrate\n      .selectAll('.x.label')\n      .data([this.view.model.get('x_field')])\n      .join('text')\n      .attr('class', 'x label')\n      // .attr(\"transform\", \"rotate(-90)\")\n      .attr('y', substHeight + 26)\n      .attr('x', substWidth + MARGIN.right / 2)\n      .style('text-anchor', 'end')\n      .text((d) => d);\n\n    // update the Y axis\n    gSubstrate.select('.y.axis').call(d3.axisLeft(yScale) as any);\n    gSubstrate\n      .selectAll('.y.label')\n      .data([this.view.model.get('y_field')])\n      .join('text')\n      .attr('class', 'y label')\n      // .attr(\"transform\", \"rotate(-90)\")\n      .attr('y', -8)\n      .attr('x', -MARGIN.left)\n      .style('text-anchor', 'start')\n      .text((d) => d);\n\n    // update the legend\n    const gLegend = gSubstrate.select('g#legend');\n    gLegend.select('text.label').text(this.view.model.get('color_field'));\n\n    gLegend\n      .selectAll('text.axis')\n      .data(colorValues)\n      .join('text')\n      .attr('class', 'axis')\n      .text((d: string) => d)\n      .style('text-anchor', 'end')\n      .attr('x', '-9')\n      .attr('y', (d, i) => i * 14 + 14);\n\n    gLegend\n      .selectAll('rect')\n      .data(colorValues)\n      .join('rect')\n      .attr('x', '-7')\n      .attr('y', (d, i) => i * 14 + 7)\n      .attr('width', '7')\n      .attr('height', '7')\n      .style('fill', (d: string) => colorScale(d));\n  }\n}\n\nfunction prepareScale(\n  values: number[],\n  range: Iterable<number>\n): d3.ScaleLinear<number, number, never> {\n  const xMin = d3.min(values) || 0;\n  const xMax = d3.max(values) || 1;\n  // console.log('%% domain: [' + xMin + ' ,' + xMax + ']');\n  const space = (xMax - xMin) * 0.05;\n  const xSpacedMin = xMin - space < 0 && xMin >= 0 ? 0 : xMin - space;\n  return d3\n    .scaleLinear()\n    .range(range)\n    .domain([xSpacedMin, xMax + space]);\n}\n","// Copyright (c) Alexander Rind & the SoniVis team.\n// Distributed under the terms of the MIT License (see LICENSE.txt).\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst data = require('../package.json');\n\n/**\n * The _model_module_version/_view_module_version this package implements.\n *\n * The html widget manager assumes that this is the same as the npm package\n * version number.\n */\nexport const MODULE_VERSION = data.version;\n\n/*\n * The current package name.\n */\nexport const MODULE_NAME = data.name;\n","// Copyright (c) Alexander Rind & the SoniVis team.\n// Distributed under the terms of the MIT License (see LICENSE.txt).\n\nimport {\n  DOMWidgetModel,\n  DOMWidgetView,\n  ISerializers,\n} from '@jupyter-widgets/base';\n\nimport { MODULE_NAME, MODULE_VERSION } from './version';\n\n// Import the CSS\nimport '../css/widget.css';\nimport { ScatterPlot } from './scatterPlot';\n\nexport class LensModel extends DOMWidgetModel {\n  defaults(): any {\n    return {\n      ...super.defaults(),\n      _model_name: LensModel.model_name,\n      _model_module: LensModel.model_module,\n      _model_module_version: LensModel.model_module_version,\n      _view_name: LensModel.view_name,\n      _view_module: LensModel.view_module,\n      _view_module_version: LensModel.view_module_version,\n\n      x_field: '',\n      y_field: '',\n      _marks_x: [] as number[],\n      _marks_y: [] as number[],\n      size: 0.1,\n      shape: 'circle',\n      width: 500,\n      height: 500,\n    };\n  }\n\n  static serializers: ISerializers = {\n    ...DOMWidgetModel.serializers,\n    // Add any extra serializers here\n  };\n\n  static model_name = 'LensModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n  static view_name = 'LensView'; // Set to null if no view\n  static view_module = MODULE_NAME; // Set to null if no view\n  static view_module_version = MODULE_VERSION;\n}\n\nexport class LensView extends DOMWidgetView {\n  // private scatterPlot: ScatterPlot;\n\n  render(): void {\n    // this.scatterPlot =\n    new ScatterPlot(this);\n  }\n}\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","var api = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./widget.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};"],"names":[],"sourceRoot":""}